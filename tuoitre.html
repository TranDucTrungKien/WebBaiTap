<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D·ª± B√°o Th·ªùi Ti·∫øt Vi·ªát Nam - Kjn Tran</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-size: 2.5em;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .selector-section {
            text-align: center;
            margin-bottom: 30px;
        }

        .selector-section label {
            font-size: 1.2em;
            color: #555;
            margin-right: 15px;
            font-weight: 600;
        }

        #citySelect {
            padding: 12px 20px;
            font-size: 1.1em;
            border: 2px solid #667eea;
            border-radius: 10px;
            background: white;
            color: #333;
            cursor: pointer;
            outline: none;
            transition: all 0.3s;
            min-width: 250px;
        }

        #citySelect:hover {
            border-color: #764ba2;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        #citySelect:focus {
            border-color: #764ba2;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
        }

        .loading {
            text-align: center;
            padding: 50px;
            font-size: 1.2em;
            color: #667eea;
        }

        .error {
            text-align: center;
            padding: 30px;
            background: #fee;
            border: 2px solid #fcc;
            border-radius: 10px;
            color: #c33;
            margin: 20px 0;
        }

        .weather-container {
            display: none;
        }

        .current-weather {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            border-radius: 15px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .current-weather h2 {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .current-weather .temp {
            font-size: 4em;
            font-weight: bold;
            margin: 20px 0;
        }

        .current-weather .description {
            font-size: 1.5em;
            text-transform: capitalize;
            margin-bottom: 20px;
        }

        .current-details {
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .detail-item {
            background: rgba(255, 255, 255, 0.2);
            padding: 15px 25px;
            border-radius: 10px;
        }

        .detail-item strong {
            display: block;
            font-size: 0.9em;
            margin-bottom: 5px;
        }

        .hourly-forecast {
            margin-top: 30px;
        }

        .hourly-forecast h3 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.8em;
            text-align: center;
        }

        .hourly-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
        }

        .hour-card {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            transition: transform 0.3s;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .hour-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }

        .hour-card .time {
            font-weight: bold;
            color: #667eea;
            font-size: 1.1em;
            margin-bottom: 10px;
        }

        .hour-card .hour-temp {
            font-size: 1.8em;
            font-weight: bold;
            color: #333;
            margin: 10px 0;
        }

        .hour-card .hour-desc {
            font-size: 0.9em;
            color: #555;
            text-transform: capitalize;
        }

        .hour-card img {
            width: 50px;
            height: 50px;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.8em;
            }

            .current-weather .temp {
                font-size: 3em;
            }

            .hourly-grid {
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üå§Ô∏è D·ª± B√°o Th·ªùi Ti·∫øt Vi·ªát Nam</h1>
        
        <div class="selector-section">
            <label for="citySelect">Ch·ªçn t·ªânh/th√†nh ph·ªë:</label>
            <select id="citySelect">
                <option value="">-- Ch·ªçn ƒë·ªãa ƒëi·ªÉm --</option>
            </select>
        </div>

        <div id="loadingDiv" class="loading" style="display: none;">
            ‚è≥ ƒêang t·∫£i d·ªØ li·ªáu th·ªùi ti·∫øt...
        </div>

        <div id="errorDiv" class="error" style="display: none;"></div>

        <div id="weatherContainer" class="weather-container">
            <div class="current-weather">
                <h2 id="cityName"></h2>
                <div class="temp" id="currentTemp"></div>
                <div class="description" id="currentDesc"></div>
                <img id="currentIcon" src="" alt="Weather Icon">
                
                <div class="current-details">
                    <div class="detail-item">
                        <strong>üíß ƒê·ªô ·∫©m</strong>
                        <span id="humidity"></span>
                    </div>
                    <div class="detail-item">
                        <strong>üí® Gi√≥</strong>
                        <span id="windSpeed"></span>
                    </div>
                    <div class="detail-item">
                        <strong>üå°Ô∏è C·∫£m gi√°c</strong>
                        <span id="feelsLike"></span>
                    </div>
                    <div class="detail-item">
                        <strong>üëÅÔ∏è T·∫ßm nh√¨n</strong>
                        <span id="visibility"></span>
                    </div>
                </div>
            </div>

            <div class="hourly-forecast">
                <h3>D·ª± b√°o theo gi·ªù</h3>
                <div id="hourlyGrid" class="hourly-grid"></div>
            </div>
        </div>
    </div>

    <script>
        // D·ªØ li·ªáu t·ªânh th√†nh Vi·ªát Nam v·ªõi ID t·ª´ cnnd.vn
        const cities = [
            {id: '2347719', name: 'An Giang'},
            {id: '20070078', name: 'B√¨nh D∆∞∆°ng'},
            {id: '20070086', name: 'B√¨nh Ph∆∞·ªõc'},
            {id: '2347731', name: 'B√¨nh Thu·∫≠n'},
            {id: '2347730', name: 'B√¨nh ƒê·ªãnh'},
            {id: '20070081', name: 'B·∫°c Li√™u'},
            {id: '20070087', name: 'B·∫Øc Giang'},
            {id: '20070084', name: 'B·∫Øc K·∫°n'},
            {id: '20070088', name: 'B·∫Øc Ninh'},
            {id: '2347703', name: 'B·∫øn Tre'},
            {id: '2347704', name: 'Cao B·∫±ng'},
            {id: '20070082', name: 'C√† Mau'},
            {id: '2347732', name: 'C·∫ßn Th∆°'},
            {id: '28301718', name: 'ƒêi·ªán Bi√™n'},
            {id: '20070085', name: 'ƒê√† N·∫µng'},
            {id: '1252375', name: 'ƒê√† L·∫°t'},
            {id: '2347720', name: 'ƒê·∫Øk L·∫Øk'},
            {id: '28301719', name: 'ƒê·∫Øk N√¥ng'},
            {id: '2347721', name: 'ƒê·ªìng Nai'},
            {id: '2347722', name: 'ƒê·ªìng Th√°p'},
            {id: '2347733', name: 'Gia Lai'},
            {id: '2347727', name: 'H√† N·ªôi'},
            {id: '2347728', name: 'TP. H·ªì Ch√≠ Minh'},
            {id: '2347734', name: 'H√† Giang'},
            {id: '2347741', name: 'H√† Nam'},
            {id: '2347736', name: 'H√† Tƒ©nh'},
            {id: '2347737', name: 'H√≤a B√¨nh'},
            {id: '20070079', name: 'H∆∞ng Y√™n'},
            {id: '20070080', name: 'H·∫£i D∆∞∆°ng'},
            {id: '2347707', name: 'H·∫£i Ph√≤ng'},
            {id: '28301720', name: 'H·∫≠u Giang'},
            {id: '2347738', name: 'Kh√°nh H√≤a'},
            {id: '2347723', name: 'Ki√™n Giang'},
            {id: '20070076', name: 'Kon Tum'},
            {id: '2347708', name: 'Lai Ch√¢u'},
            {id: '2347710', name: 'Long An'},
            {id: '2347740', name: 'L√†o Cai'},
            {id: '2347709', name: 'L√¢m ƒê·ªìng'},
            {id: '2347718', name: 'L·∫°ng S∆°n'},
            {id: '20070089', name: 'Nam ƒê·ªãnh'},
            {id: '2347742', name: 'Ngh·ªá An'},
            {id: '2347743', name: 'Ninh B√¨nh'},
            {id: '2347744', name: 'Ninh Thu·∫≠n'},
            {id: '20070091', name: 'Ph√∫ Th·ªç'},
            {id: '2347745', name: 'Ph√∫ Y√™n'},
            {id: '2347746', name: 'Qu·∫£ng B√¨nh'},
            {id: '2347711', name: 'Qu·∫£ng Nam'},
            {id: '20070077', name: 'Qu·∫£ng Ng√£i'},
            {id: '2347712', name: 'Qu·∫£ng Ninh'},
            {id: '2347747', name: 'Qu·∫£ng Tr·ªã'},
            {id: '2347748', name: 'S√≥c TrƒÉng'},
            {id: '2347713', name: 'S∆°n La'},
            {id: '2347715', name: 'Thanh H√≥a'},
            {id: '2347716', name: 'Th√°i B√¨nh'},
            {id: '20070083', name: 'Th√°i Nguy√™n'},
            {id: '2347749', name: 'Th·ª´a Thi√™n Hu·∫ø'},
            {id: '2347717', name: 'Ti·ªÅn Giang'},
            {id: '2347750', name: 'Tr√† Vinh'},
            {id: '2347751', name: 'Tuy√™n Quang'},
            {id: '2347714', name: 'T√¢y Ninh'},
            {id: '2347752', name: 'Vƒ©nh Long'},
            {id: '20070090', name: 'Vƒ©nh Ph√∫c'},
            {id: '2347729', name: 'V≈©ng T√†u'},
            {id: '2347753', name: 'Y√™n B√°i'}
        ];

        // API URL base
        const WEATHER_API_BASE = 'https://utils3.cnnd.vn/ajax/weatherinfo/';
        
        // Kh·ªüi t·∫°o dropdown
        const citySelect = document.getElementById('citySelect');
        cities.forEach(city => {
            const option = document.createElement('option');
            option.value = city.id;
            option.textContent = city.name;
            citySelect.appendChild(option);
        });

        // X·ª≠ l√Ω khi ch·ªçn t·ªânh th√†nh
        citySelect.addEventListener('change', async function() {
            const cityId = this.value;
            if (!cityId) return;
            
            const cityName = this.options[this.selectedIndex].text;
            await getWeatherData(cityId, cityName);
        });

        // H√†m l·∫•y d·ªØ li·ªáu th·ªùi ti·∫øt b·∫±ng c√°ch s·ª≠ d·ª•ng iframe proxy
        async function getWeatherData(cityId, cityName) {
            const loadingDiv = document.getElementById('loadingDiv');
            const errorDiv = document.getElementById('errorDiv');
            const weatherContainer = document.getElementById('weatherContainer');
            
            loadingDiv.style.display = 'block';
            errorDiv.style.display = 'none';
            weatherContainer.style.display = 'none';

            try {
                // S·ª≠ d·ª•ng iframe ƒë·ªÉ fetch data
                const proxyUrl = `https://api.allorigins.win/get?url=${encodeURIComponent('https://utils3.cnnd.vn/ajax/weatherinfo/' + cityId + '.htm')}`;
                
                console.log('Fetching weather for:', cityName);
                
                const response = await fetch(proxyUrl);
                
                if (!response.ok) {
                    throw new Error(`Kh√¥ng th·ªÉ l·∫•y d·ªØ li·ªáu (Status: ${response.status})`);
                }
                
                const result = await response.json();
                const apiData = JSON.parse(result.contents);
                
                // L·∫•y d·ªØ li·ªáu t·ª´ c·∫•u tr√∫c ƒë√∫ng: Data.data.datainfo
                if (!apiData.Data || !apiData.Data.data || !apiData.Data.data.datainfo) {
                    throw new Error('Kh√¥ng t√¨m th·∫•y d·ªØ li·ªáu th·ªùi ti·∫øt');
                }
                
                const weatherInfo = apiData.Data.data.datainfo;
                console.log('Weather info:', weatherInfo);
                
                displayWeather(weatherInfo, cityName);
                
            } catch (error) {
                console.error('Error:', error);
                errorDiv.innerHTML = `‚ùå L·ªói: ${error.message}`;
                errorDiv.style.display = 'block';
            } finally {
                loadingDiv.style.display = 'none';
            }
        }

        // Hi·ªÉn th·ªã th√¥ng tin th·ªùi ti·∫øt
        function displayWeather(weatherInfo, cityName) {
            // Hi·ªÉn th·ªã th·ªùi ti·∫øt hi·ªán t·∫°i
            document.getElementById('cityName').textContent = cityName;
            document.getElementById('currentTemp').textContent = weatherInfo.temperature + '¬∞C';
            document.getElementById('currentDesc').textContent = weatherInfo.status || 'Kh√¥ng r√µ';
            
            // Icon th·ªùi ti·∫øt
            const iconElement = document.getElementById('currentIcon');
            if (weatherInfo.shadow_icon) {
                iconElement.src = weatherInfo.shadow_icon;
                iconElement.style.display = 'block';
            } else {
                iconElement.style.display = 'none';
            }
            
            // Chi ti·∫øt th·ªùi ti·∫øt
            document.getElementById('humidity').textContent = weatherInfo.humidity || 'N/A';
            document.getElementById('windSpeed').textContent = weatherInfo.wind ? `${weatherInfo.wind.index} ${weatherInfo.wind.unit}` : 'N/A';
            document.getElementById('feelsLike').textContent = weatherInfo.feels_like ? `${weatherInfo.feels_like}¬∞C` : 'N/A';
            document.getElementById('visibility').textContent = weatherInfo.visibility ? `${weatherInfo.visibility.index} ${weatherInfo.visibility.unit}` : 'N/A';

            // Hi·ªÉn th·ªã d·ª± b√°o theo gi·ªù
            const hourlyGrid = document.getElementById('hourlyGrid');
            hourlyGrid.innerHTML = '';
            
            if (weatherInfo.hourly_temperature && weatherInfo.hourly_temperature.length > 0) {
                weatherInfo.hourly_temperature.forEach(item => {
                    const hourCard = document.createElement('div');
                    hourCard.className = 'hour-card';
                    
                    let iconHtml = '';
                    if (item.shadow_icon) {
                        iconHtml = `<img src="${item.shadow_icon}" alt="Weather">`;
                    }
                    
                    hourCard.innerHTML = `
                        <div class="time">${item.time}:00</div>
                        ${iconHtml}
                        <div class="hour-temp">${item.temperature}¬∞C</div>
                        <div class="hour-desc">${item.status || ''}</div>
                    `;
                    hourlyGrid.appendChild(hourCard);
                });
            }

            document.getElementById('weatherContainer').style.display = 'block';
        }

        // T·ª± ƒë·ªông load th·ªùi ti·∫øt H√† N·ªôi khi trang load
        window.addEventListener('load', () => {
            const hanoiCity = cities.find(city => city.name === 'H√† N·ªôi');
            if (hanoiCity) {
                citySelect.value = hanoiCity.id;
                getWeatherData(hanoiCity.id, hanoiCity.name);
            }
        });
    </script>
</body>
</html>
